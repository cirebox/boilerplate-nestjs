#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

# VerificaÃ§Ã£o de cobertura de testes
echo "ğŸ” Verificando cobertura de testes..."
npm run test:cov || echo "âš ï¸ Alguns testes falharam, mas permitindo push para correÃ§Ã£o"

# VerificaÃ§Ã£o de seguranÃ§a para dependÃªncias (apenas alerta)
echo "ğŸ” Verificando vulnerabilidades nas dependÃªncias..."
npm audit --audit-level=high || (
  echo ""
  echo "âš ï¸ AVISO DE SEGURANÃ‡A âš ï¸"
  echo "Foram encontradas vulnerabilidades de alto risco nas dependÃªncias."
  echo "Recomenda-se executar 'npm audit fix' ou revisar as vulnerabilidades."
  echo "Esta verificaÃ§Ã£o Ã© apenas informativa e nÃ£o bloquearÃ¡ seu push."
  echo ""
  # Retorna 0 para permitir que o push continue
  exit 0
)

# VerificaÃ§Ã£o mais rigorosa de tipos
echo "ğŸ” Verificando tipos TypeScript..."
npx tsc --noEmit --skipLibCheck || echo "âš ï¸ Alguns problemas de tipo foram encontrados, mas permitindo push para correÃ§Ã£o"